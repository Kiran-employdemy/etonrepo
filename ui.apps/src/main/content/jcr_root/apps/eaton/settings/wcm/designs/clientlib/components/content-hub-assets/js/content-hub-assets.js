/**
 *
 *
 *
 * - THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY -
 * - Generated by Gulp (gulp-babel).
 *
 *
 *
 *
 */


'use strict';

$(document).ready(function () {
  if ($('#content-hub-assets__component_id').length) {
    var totalResultsCount = $('#content-hub-assets__component_id').data('result-list-size');
    var initialResultsLoadSize = $('#content-hub-assets__component_id').data('initial-results-to-load');
    var defaultIconPath = $('#content-hub-assets__component_id').data('default-icon-path');
    var numberOfResultsLoaded = 0;
    var singleFilterFlag = false;
    var multiGroupFilterIndex = 0;
    var loadMoreCount = 1;
    var resultListWithFilterSelection = [];
    if (totalResultsCount > initialResultsLoadSize) {
      contenthubAssetsResultsDisplay(0, initialResultsLoadSize, defaultIconPath);
      $('#contentHubAssetsLoadMore').removeClass('hide');
    } else if (totalResultsCount > 0 && totalResultsCount < initialResultsLoadSize) {
      contenthubAssetsResultsDisplay(0, totalResultsCount, defaultIconPath);
    } else if (totalResultsCount === initialResultsLoadSize) {
      contenthubAssetsResultsDisplay(0, initialResultsLoadSize, defaultIconPath);
    }
    if (totalResultsCount > initialResultsLoadSize) {
      $('#contentHubAssetsLoadMore').removeClass('hide');
    }
    $('#contentHubAssetsLoadMore').click(function () {
      numberOfResultsLoaded = numberOfResultsLoaded + initialResultsLoadSize <= totalResultsCount ? numberOfResultsLoaded + initialResultsLoadSize : totalResultsCount;
      if (numberOfResultsLoaded + initialResultsLoadSize >= totalResultsCount) {
        $('#contentHubAssetsLoadMore').addClass('hide');
      }
      if (multiGroupFilterIndex > 1 || singleFilterFlag === true) {
        loadMoreCount++;
        assetsResultsDisplayWithFilter(resultListWithFilterSelection, 0, initialResultsLoadSize * loadMoreCount, defaultIconPath);
      } else {
        contenthubAssetsResultsDisplay(numberOfResultsLoaded, initialResultsLoadSize, defaultIconPath);
      }
    });

    $('.faceted-navigation__facet-value-label .input--small').click(function () {
      $('.content-hub-assets__card-list-results').empty();
      var filterSelected = false;
      var cardDisplayed = [];
      var cardDisplayedIndex = 0;
      var multiGroupFilter = [];
      var multiGroupFilterFacets = [];
      var groupNames = [];
      multiGroupFilterIndex = 0;
      loadMoreCount = 1;
      var multiGroupFilterFacetsIndex = 0;
      var groupNamesIndex = 0;
      resultListWithFilterSelection = [];
      $('.input--small').each(function () {
        if ($(this).prop('checked') === true) {
          var checkBoxId = $(this).attr('id');
          if (!multiGroupFilter.includes(checkBoxId)) {
            multiGroupFilter[multiGroupFilterIndex] = checkBoxId;
            multiGroupFilterFacets[multiGroupFilterFacetsIndex] = $(this).val();
            multiGroupFilterIndex++;
            multiGroupFilterFacetsIndex++;
          }
          groupNames[groupNamesIndex] = checkBoxId + '$' + $(this).attr('data-tagId');
          groupNamesIndex++;
        }
      });

      if (multiGroupFilterIndex > 1) {
        $('.input--small').each(function () {

          if ($(this).prop('checked') === true) {
            filterSelected = true;
            var checkedFilterValue = $(this).attr('data-tagId');
            var resultList = $('#content-hub-assets__component_id').data('result-list-json').slice(0, totalResultsCount);
            $.each(resultList, function (key, value) {
              var cqTagIds = resultList[key].cqTagsWithPath;
              if ($.inArray(checkedFilterValue, cqTagIds) !== -1) {

                var flag = flagCheck(cqTagIds, groupNames, multiGroupFilterIndex);

                if (flag === true) {
                  if (!cardDisplayed.includes(resultList[key].assetPath)) {
                    cardDisplayed[cardDisplayedIndex] = resultList[key].assetPath;
                    var item = {};
                    item.linkImageAltText = resultList[key].linkImageAltText;
                    item.assetEyebrowTag = resultList[key].assetEyebrowTag;
                    item.assetType = resultList[key].assetType;
                    item.assetSize = resultList[key].assetSize;
                    item.assetPath = resultList[key].assetPath;
                    item.assetTitle = resultList[key].assetTitle;
                    item.linkImage = resultList[key].linkImage;
                    item.productImageBean = resultList[key].productImageBean;
                    item.publicationDateDisplay = resultList[key].publicationDateDisplay;
                    resultListWithFilterSelection.push(item);
                    cardDisplayedIndex++;
                  }
                }
              }
            });
          }
        });
        if (cardDisplayedIndex === 0) {
          // Fix for failed test case, hide load more button
          $('#contentHubAssetsLoadMore').addClass('hide');
        }

        assetsResultsDisplayWithFilter(resultListWithFilterSelection, 0, initialResultsLoadSize, defaultIconPath);

        if (filterSelected === false) {

          contenthubAssetsResultsDisplay(0, initialResultsLoadSize, defaultIconPath);
          $('#contentHubAssetsLoadMore').removeClass('hide');
        }
      } else {
        $('.input--small').each(function () {
          if ($(this).prop('checked') === true) {
            filterSelected = true;
            var checkedFilterValue = $(this).attr('data-tagId');
            var resultList = $('#content-hub-assets__component_id').data('result-list-json').slice(0, totalResultsCount);
            $.each(resultList, function (key, value) {
              var cqTagIds = resultList[key].cqTagsWithPath;
              if ($.inArray(checkedFilterValue, cqTagIds) !== -1) {
                if (!cardDisplayed.includes(resultList[key].assetPath)) {
                  cardDisplayed[cardDisplayedIndex] = resultList[key].assetPath;
                  var item = {};
                  item.linkImageAltText = resultList[key].linkImageAltText;
                  item.assetType = resultList[key].assetType;
                  item.assetSize = resultList[key].assetSize;
                  item.assetEyebrowTag = resultList[key].assetEyebrowTag;
                  item.assetPath = resultList[key].assetPath;
                  item.assetTitle = resultList[key].assetTitle;
                  item.linkImage = resultList[key].linkImage;
                  item.productImageBean = resultList[key].productImageBean;
                  item.publicationDateDisplay = resultList[key].publicationDateDisplay;
                  resultListWithFilterSelection.push(item);
                  cardDisplayedIndex++;
                  singleFilterFlag = true;
                }
              }
            });
          }
        });
        if (cardDisplayedIndex === 0) {
          // Fix for failed test case, hide load more button
          $('#contentHubAssetsLoadMore').addClass('hide');
        }

        assetsResultsDisplayWithFilter(resultListWithFilterSelection, 0, initialResultsLoadSize, defaultIconPath);

        if (filterSelected === false) {
          totalResultsCount = $('#content-hub-assets__component_id').data('result-list-size');
          initialResultsLoadSize = $('#content-hub-assets__component_id').data('initial-results-to-load');
          numberOfResultsLoaded = 0;
          multiGroupFilterIndex = 0;
          singleFilterFlag = false;
          contenthubAssetsResultsDisplay(0, initialResultsLoadSize, defaultIconPath);
          if (totalResultsCount > initialResultsLoadSize) {
            $('#contentHubAssetsLoadMore').removeClass('hide');
          }
        }
      }
    });

    $('#contentHubAssets-filters').click(function (e) {
      $('body').addClass('facets-open');
      e.stopPropagation();
    });
    $('#contenthub-filterClose').click(function (e) {
      $('body').removeClass('facets-open');
      e.stopPropagation();
    });

    var assetsSearchDisply = function assetsSearchDisply(searchInput, searchArray) {
      var currentFocus = void 0;
      searchInput.addEventListener('input', function (e) {
        var divCreate = this.value;
        var searchReslt = this.value;
        var i = this.value;
        var val = this.value;
        var cardDisplayed = [];
        var cardDisplayedIndex = 0;
        closeAllLists();
        if (!val) {
          $('.content-hub-assets__card-list-results').empty();
          $('.input--small').prop('checked', false);
          totalResultsCount = $('#content-hub-assets__component_id').data('result-list-size');
          initialResultsLoadSize = $('#content-hub-assets__component_id').data('initial-results-to-load');
          numberOfResultsLoaded = 0;
          multiGroupFilterIndex = 0;
          singleFilterFlag = false;
          contenthubAssetsResultsDisplay(0, initialResultsLoadSize, defaultIconPath);
          if (totalResultsCount > initialResultsLoadSize) {
            $('#contentHubAssetsLoadMore').removeClass('hide');
          }
          return false;
        }
        currentFocus = -1;
        divCreate = document.createElement('DIV');
        divCreate.setAttribute('id', this.id + 'autocomplete-list');
        divCreate.setAttribute('class', 'autocomplete-items');
        this.parentNode.appendChild(divCreate);
        for (i = 0; i < searchArray.length; i++) {
          if (searchArray[i].substr(0, val.length).toUpperCase() === val.toUpperCase()) {
            searchReslt = document.createElement('DIV');
            searchReslt.innerHTML = '<strong>' + searchArray[i].substr(0, val.length) + '</strong>';
            searchReslt.innerHTML += searchArray[i].substr(val.length);
            searchReslt.innerHTML += '<input type=\'hidden\' value=\'' + searchArray[i] + '\'>';
            searchReslt.addEventListener('click', function (event) {
              searchInput.value = this.getElementsByTagName('input')[0].value;
              /* eslint-disable  no-unused-vars*/
              var filterSelected = false;
              /* eslint-enable  no-unused-vars*/
              $('#myInputautocomplete-list').click(function () {
                var searchText = searchInput.value;
                $('.input--small').each(function () {
                  $(this).val() === searchText ? $(this).prop('checked', true) : $(this).prop('checked', false);
                });
                $('.content-hub-assets__card-list-results').empty();
                filterSelected = false;
                resultListWithFilterSelection = [];
                $('.input--small').each(function () {
                  if ($(this).prop('checked') === true) {
                    loadMoreCount = 1;
                    filterSelected = true;
                    var checkedFilterValue = $(this).attr('data-tagId');
                    var resultList = $('#content-hub-assets__component_id').data('result-list-json').slice(0, totalResultsCount);
                    $.each(resultList, function (key, value) {
                      var cqTagIds = resultList[key].cqTagsWithPath;
                      if ($.inArray(checkedFilterValue, cqTagIds) !== -1) {
                        if (!cardDisplayed.includes(resultList[key].assetPath)) {
                          cardDisplayed[cardDisplayedIndex] = resultList[key].assetPath;
                          var item = {};
                          item.linkImageAltText = resultList[key].linkImageAltText;
                          item.assetEyebrowTag = resultList[key].assetEyebrowTag;
                          item.assetType = resultList[key].assetType;
                          item.assetSize = resultList[key].assetSize;
                          item.assetPath = resultList[key].assetPath;
                          item.assetTitle = resultList[key].assetTitle;
                          item.linkImage = resultList[key].linkImage;
                          item.productImageBean = resultList[key].productImageBean;
                          item.publicationDateDisplay = resultList[key].publicationDateDisplay;
                          resultListWithFilterSelection.push(item);
                          cardDisplayedIndex++;
                          singleFilterFlag = true;
                        }
                      }
                      if (cardDisplayedIndex < initialResultsLoadSize) // Hide Load more if card count is less than initial load size
                        {
                          $('#contentHubAssetsLoadMore').addClass('hide');
                        }
                      assetsResultsDisplayWithFilter(resultListWithFilterSelection, 0, initialResultsLoadSize, defaultIconPath);
                      if (cardDisplayedIndex === 0) {
                        $('#contentHubAssetsLoadMore').addClass('hide');
                      }
                    });
                  }
                });
              });
              closeAllLists();
            });
            divCreate.appendChild(searchReslt);
          }
        }
      });
      searchInput.addEventListener('keydown', function (e) {
        var x = document.getElementById(this.id + 'autocomplete-list');
        if (x) {
          x = x.getElementsByTagName('div');
        }
        if (e.keyCode === 40) {
          currentFocus++;
          addActive(x);
        } else if (e.keyCode === 38) {
          currentFocus--;
          addActive(x);
        } else if (e.keyCode === 13) {
          e.preventDefault();
          if (currentFocus > -1) {
            if (x) {
              x[currentFocus].click();
            }
          }
        }
      });
      function addActive(x) {
        if (!x) {
          return false;
        }
        removeActive(x);
        if (currentFocus >= x.length) {
          currentFocus = 0;
        }
        if (currentFocus < 0) {
          currentFocus = x.length - 1;
        }
        x[currentFocus].classList.add('autocomplete-active');
      }
      function removeActive(x) {
        for (var i = 0; i < x.length; i++) {
          x[i].classList.remove('autocomplete-active');
        }
      }
      function closeAllLists(elmnt) {
        var x = document.getElementsByClassName('autocomplete-items');
        for (var i = 0; i < x.length; i++) {
          if (elmnt !== x[i] && elmnt !== searchInput) {
            x[i].parentNode.removeChild(x[i]);
          }
        }
      }
      document.addEventListener('click', function (e) {
        closeAllLists(e.target);
      });
    };
    var facetFilters = [];
    var checkboxes = document.querySelectorAll('input[type=checkbox]');
    // eslint-disable-next-line no-eq-null, eqeqeq
    if (checkboxes.length != 0) {
      for (var i = 0; i < checkboxes.length; i++) {
        facetFilters.push(checkboxes[i].value);
      }
    }
    assetsSearchDisply(document.getElementById('myInput'), facetFilters);

    jQuery(function () {
      var maxItemsAllowed = 7;

      var listItems = jQuery('.collapse.in li').length;
      $('.collapse.in').each(function () {
        var filterItemsList = $(this).find('.faceted-navigation__list-item').length;

        if (filterItemsList < maxItemsAllowed) {
          $(this).find('.faceted-navigation__view-more-less-container').removeClass('show');
        }
        var viewMoreCount = filterItemsList - maxItemsAllowed;
        $(this).find('.faceted-navigation__view-more-values__count').html('(' + viewMoreCount + ')');
      });

      if (listItems > maxItemsAllowed) {
        jQuery('.collapse.in li:nth-child(+n+' + (maxItemsAllowed + 1) + ')').addClass('hidelist');
      }
    });

    $('button.faceted-navigation__view-more-values').click(function () {
      $(this).hide();
      $(this).next().show();
      $(this).parent().parent().find('.hidelist').addClass('show');
    });

    $('button.faceted-navigation__view-less-values').click(function () {
      $(this).hide();
      $(this).prev().show();
      $(this).parent().parent().find('.hidelist').removeClass('show');
    });
  }
});

var contenthubAssetsResultsDisplay = function contenthubAssetsResultsDisplay(startingNumber, lotSize, defaultIconPath) {
  if ($('#content-hub-assets__component_id').data('result-list-size') > 0) {
    var resultList = $('#content-hub-assets__component_id').data('result-list-json').slice(startingNumber, startingNumber + lotSize);
    $.each(resultList, function (key, value) {
      var imageSource = resultList[key].linkImage ? resultList[key].linkImage : defaultIconPath;
      $('.content-hub-assets__card-list-results').append(assetsCardHtml(imageSource, resultList[key].productImageBean, resultList[key].linkImageAltText, resultList[key].assetEyebrowTag, resultList[key].assetType, resultList[key].assetSize, resultList[key].assetPath, resultList[key].assetTitle, resultList[key].publicationDateDisplay), resultList[key].taxonomy);
    });
  }
};

var assetsResultsDisplayWithFilter = function assetsResultsDisplayWithFilter(resultListWithFilterSelection, startingNumber, displayCount, defaultIconPath) {
  if (resultListWithFilterSelection.length > 0) {

    $('.content-hub-assets__card-list-results').empty();

    if (resultListWithFilterSelection.length > displayCount) {
      $('#contentHubAssetsLoadMore').removeClass('hide');
    }
    if (resultListWithFilterSelection.length <= displayCount) {
      $('#contentHubAssetsLoadMore').addClass('hide');
    }
    var resultList = resultListWithFilterSelection.slice(startingNumber, displayCount);
    $.each(resultList, function (key, value) {
      var imageSource = resultList[key].linkImage ? resultList[key].linkImage : defaultIconPath;
      $('.content-hub-assets__card-list-results').append(assetsCardHtml(imageSource, resultList[key].productImageBean, resultList[key].linkImageAltText, resultList[key].assetEyebrowTag, resultList[key].assetType, resultList[key].assetSize, resultList[key].assetPath, resultList[key].assetTitle, resultList[key].publicationDateDisplay));
    });
  }
};

var flagCheck = function flagCheck(cqTagIds, groupNames, multiGroupFilterIndex) {
  var tempFlag = false;
  var tempArray = [];
  var groupNameArray = [];
  var tempArrayIndex = 0;

  for (var count = 0; count < groupNames.length; count++) {
    var filterTag = groupNames[count].split('$');
    for (var innerCount = 0; innerCount < cqTagIds.length; innerCount++) {
      if (cqTagIds[innerCount] === filterTag[1]) {
        if (!groupNameArray.includes(filterTag[0])) {
          tempArray[tempArrayIndex] = true;
          groupNameArray[tempArrayIndex] = filterTag[0];
          tempArrayIndex++;
        }
      }
    }
  }

  tempFlag = multiGroupFilterIndex === tempArray.length ? tempFlag : !tempFlag;
  return tempFlag;
};

var assetsCardHtml = function assetsCardHtml(imageSource, productImageBean, linkImageAltText, assetEyebrowTag, assetType, assetSize, assetPath, assetTitle, publicationDateDisplay) {
  var htmlString = '';
  var imageRenditionString = '<div class="rendition-bg rendition-bg--alignment desktop-center-center mobile-center-center"\n\tdata-src="' + productImageBean.mobileTransformedUrl + '"\n\tdata-mobile-rendition="' + productImageBean.mobileTransformedUrl + '"\n\tdata-tablet-rendition="' + productImageBean.tabletTransformedUrl + '"\n\tdata-desktop-rendition="' + productImageBean.desktopTransformedUrl + '" style=" background-image: url(' + productImageBean.desktopTransformedUrl + ')"></div>';
  var publicationDateDisplayHTML = '';
  if (publicationDateDisplay) {
    publicationDateDisplayHTML = '<div class="featured-article-card__date b-body-copy-small"><em>' + publicationDateDisplay + '</em></div>\n';
  }
  htmlString = '<div class="content-hub-assets__card-list-results-item col-sm-12 col-md-3 col-xs-12">\n                  <div class="content-hub-assets__card-list-results-item__card">\n                   <a href=" ' + assetPath + '" target = "_blank">\n                     <div class="content-hub-assets__card-list-results-item__card--image without-filter">\n                      ' + imageRenditionString + '\n                     </div>\n                   </a>\n                   <div class="content-hub-assets__card-list-results-item__card--content">\n                   <p class="content-hub-assets__card-list-results-item__card--content__eyebrowTitle b-eyebrow-small"> ' + assetEyebrowTag + ' </p>\n                   <p class="content-hub-assets__card-list-results-item__card--content__heading b-heading-h5">\n                   <a href=" ' + assetPath + '" target = "_blank"> ' + assetTitle + '</a>\n                   </p>\n\t\t\t\t   ' + publicationDateDisplayHTML + '\n                    </div>\n                     <div class="content-hub-assets__card-list-results-item__card--download">\n                         <a href=" ' + assetPath + '" download="' + assetTitle + '"> <i class="icon icon-download"></i></a>\n                            <div class="content-hub-assets__card-list-results-item__card--download__type">\n                                <span>Type: <span class="assettype">' + assetType + '</span></span>\n                                <span>size: ' + assetSize + '</span>\n                            </div>\n                     </div>\n                    </div>\n                    </div>';

  return htmlString;
};