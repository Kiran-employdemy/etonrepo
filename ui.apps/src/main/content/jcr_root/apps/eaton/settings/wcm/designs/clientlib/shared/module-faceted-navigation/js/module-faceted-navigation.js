/**
 *
 *
 *
 * - THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY -
 * - Generated by Gulp (gulp-babel).
 *
 *
 *
 *
 */


'use strict';

var App = window.App || {};
App.facets = function () {
  var $sortOptionsNode = Array.from(document.querySelectorAll('.faceted-navigation-header .dropdown-menu li a'));
  var $initialSort = document.querySelector('.faceted-navigation-header__default--option:not(.cross-reference-sort)');

  var init = function init() {
    $(function () {
      addEventListeners();
      matchPath();
      localStorage.setItem('backToSearch', 'true');
    });
  };

  var addEventListeners = function addEventListeners() {
    $('.native-select').on('change', navigateSelect);
  };

  /** grabing the value of the sorting order from the url and setting that as the placeholder, adding class to currently selected sort order */
  var matchPath = function matchPath() {
    if ($initialSort) {
      var currentSort = $initialSort.getAttribute('data-default-sorting-title');
      var buildLabel = '<span class="faceted-navigation-header__sort-link"> ' + currentSort + '</span>';
      var defaultSortingValue = true;
      var urlSorting = false;
      $sortOptionsNode.forEach(function (index) {
        var urlParams = window.location.pathname;
        if (index.pathname === urlParams) {
          buildLabel = index.innerHTML;
          defaultSortingValue = false;
          index.className += ' faceted-navigation-header__sort-options--selected';
          return urlSorting = true;
        }
        return urlSorting = false;
      });

      if (urlSorting === false) {
        $sortOptionsNode.forEach(function (index) {
          if (currentSort && defaultSortingValue === true) {
            if (index.innerHTML.trim() === currentSort.trim()) {
              index.className += ' faceted-navigation-header__sort-options--selected';
              defaultSortingValue = false;
            }
          }
        });
      }
      $initialSort.innerHTML = buildLabel;
      var emptyCheck = $initialSort.childNodes[0].innerText;

      if (emptyCheck !== undefined) {
        if (emptyCheck.replace(/^\s\s*/, '').replace(/\s\s*$/, '') === 'null') {
          $initialSort.childNodes[0].innerText = $initialSort.getAttribute('data-default-fallback');
          document.querySelector('.faceted-navigation-header__title').style.display = 'none';
        }
      }
    }
  };

  /**
  * toggle the mobile factes modal
  * @param  { Object } event - the click event object
  */
  var navigateSelect = function navigateSelect(e) {
    e.preventDefault();
    var urlToNavigate = $('.native-select option:selected')[0].value;
    document.location.href = urlToNavigate;
  };

  init();
}();