/**
 *
 *
 *
 * - THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY -
 * - Generated by Gulp (gulp-babel).
 *
 *
 *
 *
 */


'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var currentDate = new Date();
var specificationTab = void 0;
var resourceTab = void 0;
var overviewTab = void 0;
var skunumber = void 0;

var Prodspecification = function () {
  function Prodspecification() {
    _classCallCheck(this, Prodspecification);
  }

  _createClass(Prodspecification, [{
    key: 'init',
    value: function init() {
      skunumber = $('.eaton-product-tabs__description').children('.b-heading-h5').text();
      // eslint-disable-next-line no-unused-vars
      var dataSheetName = $('.eaton-product-tabs__description').children('.b-heading-h5').text().trim() + '.xlsx';
      // Do not append the SKU no. so just bypass - $('#export-btn').append(dataSheetName);
      $('#sku-number').attr('data-sku-number', skunumber);
      $('#sku-number').attr('data-sku-extension', 'Excel (.XLSX)');
      $('#sku-number').html($('#sku-number').attr('data-sku-file-anchor-text') + ' ' + $('#sku-number').attr('data-sku-extension'));
      this.finalTable();
    }
  }, {
    key: 'specificationData',
    value: function specificationData() {
      specificationTab = $('.module-table__row').map(function () {
        var issue = $(this);
        var tdline = issue.find('.module-table__col').map(function () {
          return '<td data-f-bold = "true"><b>' + $(this).parent().parent().parent().find('.module-table__head').text() + '</b></td><td>' + $(this).text();
        }).get().join('</td>');
        return '<tr>' + tdline + '</td>';
      }).get().join('</tr>');
    }
  }, {
    key: 'resourceData',
    value: function resourceData() {
      resourceTab = $('.excel-title-resource-tab').map(function () {
        var issue = $(this);
        var tdline = issue.find('.resource-list__title-link').map(function () {
          return '<td data-f-bold = "true"><b>' + $(this).attr('name') + '</b></td><td data-underline="true" data-f-color="0000FF" data-hyperlink= "' + $(this).attr('href') + '"><a href="' + $(this).attr('href') + '" >' + $(this).text();
        }).get().join('</td>');
        return '<tr>' + tdline + '</td>';
      }).get().join('</tr>');
    }
  }, {
    key: 'overviewData',
    value: function overviewData() {
      overviewTab = $('.module-product-detail-card').map(function () {
        var issue = $(this);
        var tdline = issue.find('.excel_class').map(function () {
          return '<td>' + $(this).text();
        }).get().join('</td>');
        return '<tr>' + tdline + '</td>';
      }).get().join('</tr>');
    }
  }, {
    key: 'removeDuplicates',
    value: function removeDuplicates() {
      var tablelen = $('#excel-table tr').length;
      var tableRows = $('#excel-table').find('tbody tr');

      for (var i = 1; i < tablelen; i++) {
        var tRow = $(tableRows[i]);
        var cell1Content = tRow.find('td:nth-child(3)').text();
        var cell2Content = tRow.find('td:nth-child(1)').text();
        if (cell1Content === cell2Content) {
          tRow.find('td:nth-child(3)').remove();
        }
      }

      var seen = {};
      $('#excel-table tr td').each(function () {
        var subheaderTxt = $(this).text();
        if (seen[subheaderTxt]) {
          $(this).text('');
        } else {
          seen[subheaderTxt] = true;
        }
      });
    }
  }, {
    key: 'tablePreparations',
    value: function tablePreparations() {
      var date = '<tr><td data-f-bold = "true"><b>Date</b></td><td>' + currentDate.toDateString() + '</td></tr>';
      specificationTab = '<table id="excel-table" data-cols-width="30,40,50">' + overviewTab + specificationTab + resourceTab + date + '</tr></table>';
      $('#excelconverttable').append(specificationTab);

      var prodspec = new Prodspecification();
      prodspec.removeDuplicates();

      $('#excel-table').find('tr').each(function (i, el) {
        $(this).find('td').attr('data-a-wrap', 'true');
        $(this).find('td').attr('data-a-v', 'middle');
      });
    }
  }, {
    key: 'finalTable',
    value: function finalTable() {
      $('.excel__convert-download').removeClass('hide');
      var $accordion = $('.secondary-content-accordion__panel');
      if ($accordion && $accordion.length > 0) {
        $accordion.on('hidden.bs.collapse', function (e) {
          $(e.target).prev('.panel-heading').find('.secondary-content-accordion-datasheet__icons').toggleClass('icon-sign-plus icon-sign-minus');
        });
        $accordion.on('shown.bs.collapse', function (e) {
          $(e.target).prev('.panel-heading').find('.secondary-content-accordion-datasheet__icons').toggleClass('icon-sign-plus icon-sign-minus');
        });
      }
      $('#export-btn').on('click', function (e) {
        var prodspec = new Prodspecification();
        prodspec.overviewData();
        prodspec.specificationData();
        prodspec.resourceData();
        prodspec.tablePreparations();
        // eslint-disable-next-line no-undef
        TableToExcel.convert(document.getElementById('excel-table'), {
          name: $.trim(skunumber) + '.xlsx',
          sheet: {
            name: $.trim(skunumber)
          }
        });
        $('#excel-table').remove();
      });
    }
  }]);

  return Prodspecification;
}();

(function () {
  var prodspec = $('#excelconverttable').length;
  if (prodspec > 0) {
    new Prodspecification().init();
  }
})();

/** Script to handle page scroll in sku page. */
$(document).ready(function () {
  var target = window.location.hash;
  if (target === '#Specifications' || target === '#Resources') {
    $('div#Specifications').css('margin-top', '60px');
    $('div#Specifications').css('margin-bottom', '60px');
    $('div#Resources').css('margin-top', '60px');
  }
  var offset = 200; // You can change this value as per your need.
  if ($(target).length > 0) {
    $('html, body').animate({
      scrollTop: $(target).offset().top - offset
    }, 600);
  }
});